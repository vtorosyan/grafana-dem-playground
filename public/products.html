<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEM Playground - Products</title>
    <link rel="stylesheet" href="/styles.css">
    <script src="/faro-init.js"></script>
</head>
<body>
    <div class="container">
        <header data-testid="page-header">
            <h1 data-testid="page-title">Products</h1>
            <div class="version" id="version" data-testid="app-version">Loading...</div>
        </header>

        <nav data-testid="main-nav">
            <a href="/" data-testid="nav-home">Home</a>
            <a href="/checkout" data-testid="nav-checkout">Checkout</a>
            <a href="/status" data-testid="nav-status">Status</a>
        </nav>

        <main>
            <section data-testid="products-section">
                <h2>Product List</h2>
                <div id="products-list" data-testid="products-list">
                    <p>Loading products...</p>
                </div>
            </section>
        </main>
    </div>

    <script src="/app.js"></script>
    <script>
        // Load products from API
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const res = await fetch('/api/products');
                const data = await res.json();
                const list = document.getElementById('products-list');
                list.innerHTML = data.products.map(p => `
                    <div class="product-item" data-testid="product-${p.id}">
                        <span data-testid="product-name">${p.name}</span>
                        <span data-testid="product-price">$${p.price}</span>
                        <a href="/api/products/${p.id}" data-testid="product-link-${p.id}" target="_blank" rel="noopener">View API</a>
                    </div>
                `).join('');
            } catch (e) {
                document.getElementById('products-list').innerHTML = '<p class="error-text">Failed to load products</p>';
            }
        });
    </script>
</body>
</html>
